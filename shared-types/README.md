# shared-types

A Rust crate providing common data structures and event definitions for the semantic search engine pipeline.

## Overview

This crate serves as the central type library for the semantic search engine, ensuring consistent data structures across all components of the ingestion, vectorization, and indexing pipeline. By centralizing these types, we maintain strong type safety and avoid duplication across microservices.

## Features

- **Type-safe data structures** for documents and vector embeddings
- **Event definitions** for pipeline communication
- **Serialization/Deserialization** support via `serde`
- **UUID-based identification** for document tracking

## Core Types

### DocumentPayload

The primary entity representing a document (resume, job description, etc.) in the system.

```rust
pub struct DocumentPayload {
    pub id: Uuid,        // Unique identifier generated at ingestion
    pub content: String, // Raw text content to be embedded
}
```

### DenseVector

Type alias for vector embeddings generated by transformer models.

```rust
pub type DenseVector = Vec<f32>;
```

Standard transformer models (like BERT-base) typically output 768-dimensional vectors.

## Event Definitions

### DocumentReceivedEvent

Emitted by the **Ingestion API** when valid text is received.

**Consumer:** Vectorization Worker

```rust
pub struct DocumentReceivedEvent {
    pub payload: DocumentPayload,
}
```

### DocumentVectorizedEvent

Emitted by the **Vectorization Worker** after successful ML inference.

**Consumer:** Indexing Worker

```rust
pub struct DocumentVectorizedEvent {
    pub id: Uuid,           // Original document ID
    pub vector: DenseVector, // Generated embedding
}
```

## Pipeline Flow

```
Ingestion API
    ↓ (DocumentReceivedEvent)
Vectorization Worker
    ↓ (DocumentVectorizedEvent)
Indexing Worker
```

## Usage

Add this crate as a dependency in your `Cargo.toml`:

```toml
[dependencies]
shared-types = { path = "../shared-types" }
```

Then import the types you need:

```rust
use shared_types::{
    DocumentPayload, 
    DenseVector,
    DocumentReceivedEvent,
    DocumentVectorizedEvent
};
```

## Dependencies

- **serde** (1.0) - Serialization framework with derive macros
- **uuid** (1.0) - UUID generation and handling with serde support

## Design Principles

1. **Centralization** - Single source of truth for shared types
2. **Type Safety** - Leverages Rust's strong type system
3. **Extensibility** - Designed for future metadata additions
4. **Interoperability** - Full serde support for JSON/MessagePack/etc.

## Future Enhancements

- Additional metadata fields (timestamps, source info, tags)
- Validation logic for document content
- Sparse vector support for hybrid search
- Custom serialization optimizations

## License

See the LICENSE file in the parent directory.
